{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2021/11/pattern-matching-empty-map-with-elixir/","result":{"data":{"site":{"siteMetadata":{"repsitory":"https://github.com/tmr08c/tmr08c.github.io"}},"markdownRemark":{"id":"90e97e07-50f2-5471-b41f-40a1ada951c2","excerpt":"Unlike lists, using an empty map in pattern matching does not only match empty maps; it matches empty and populated maps. This was a bit of a surprise for meâ€¦","html":"<p>Unlike lists, using an empty map in pattern matching does not only match empty maps; it matches empty and populated maps.</p>\n<pre class=\"grvsc-container tomorrow grvsc-ps-tJmpaV\" data-language=\"ex\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> [] </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">=</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> [</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">,</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">2</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">,</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">3</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">**</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> (</span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">MatchError</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">) no match of right hand side </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">value:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> [</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">2</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">3</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> %{} </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">=</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> %{</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">a:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">b:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">2</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">c:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">3</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">%{</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">a:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">b:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">2</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">c:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">3</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">}</span></span></span></code></pre>\n<p>This was a bit of a surprise for me when attempting to match an empty list, so I wanted to share how you can pattern match an empty map (aka re-write the answers I found on <a href=\"https://stackoverflow.com/questions/33248816/pattern-match-function-against-empty-map\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this StackOverflow post</a>).</p>\n<p>There appear to be two primary options for matching on an empty list.</p>\n<ol>\n<li>You can use <code>==</code> and compare it to an empty map.</li>\n</ol>\n<pre class=\"grvsc-container tomorrow grvsc-ps-tJmpaV\" data-language=\"ex\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">def</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-10 grvsc-tJmpaV-10\">my_fun</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">(map) </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">when</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> map </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">==</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> %{}</span></span></span></code></pre>\n<ol start=\"2\">\n<li>You can use the <a href=\"https://hexdocs.pm/elixir/1.12/Kernel.html#map_size/1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code>map_size/1</code></a> guard clause and compare it to <code>0</code>.</li>\n</ol>\n<pre class=\"grvsc-container tomorrow grvsc-ps-tJmpaV\" data-language=\"ex\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">def</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-10 grvsc-tJmpaV-10\">my_fun</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">(map) </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">when</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> map_size(map) </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">==</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">0</span></span></span></code></pre>\n<p>I was curious if there was a performance implication to either choice, so I wrote a benchmark script to compare the options.</p>\n<pre class=\"grvsc-container tomorrow grvsc-ps-tJmpaV\" data-language=\"ex\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">Mix</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.install([</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">:benchee</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">defmodule</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> EmptyMapMatch </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">def</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-10 grvsc-tJmpaV-10\">using_size</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">(map) </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">when</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> map_size(map) </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">==</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">0</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">do:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> map</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">def</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-10 grvsc-tJmpaV-10\">using_size</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">(map), </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">do:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> map</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">def</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-10 grvsc-tJmpaV-10\">empty_map</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">(map) </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">when</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> map </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">==</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> %{}, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">do:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> map</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">def</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-10 grvsc-tJmpaV-10\">empty_map</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">(map), </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">do:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> map</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">Benchee</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.run(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  %{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">    </span><span class=\"grvsc-t564vY-7 grvsc-tJmpaV-7\">&quot;checking size&quot;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">=&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">fn</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> input </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">-&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">EmptyMapMatch</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.using_size(input) </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">end</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">    </span><span class=\"grvsc-t564vY-7 grvsc-tJmpaV-7\">&quot;matching map&quot;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">=&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">fn</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> input </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">-&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">EmptyMapMatch</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.empty_map(input) </span><span class=\"grvsc-t564vY-11 grvsc-tJmpaV-11\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">inputs:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> %{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">    </span><span class=\"grvsc-t564vY-7 grvsc-tJmpaV-7\">&quot;Empty&quot;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">=&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> %{},</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">    </span><span class=\"grvsc-t564vY-7 grvsc-tJmpaV-7\">&quot;Small&quot;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">=&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">Enum</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.zip(</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">..</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">100</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">..</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">100</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">) </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">|&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">Enum</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.into(%{}),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">    </span><span class=\"grvsc-t564vY-7 grvsc-tJmpaV-7\">&quot;Medium&quot;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">=&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">Enum</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.zip(</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">..</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1_000</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">..</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1_000</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">) </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">|&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">Enum</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.into(%{}),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">    </span><span class=\"grvsc-t564vY-7 grvsc-tJmpaV-7\">&quot;Large&quot;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">=&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">Enum</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.zip(</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">..</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">10_000</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">, </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">1</span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">..</span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">10_000</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">) </span><span class=\"grvsc-t564vY-6 grvsc-tJmpaV-6\">|&gt;</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-8 grvsc-tJmpaV-8\">Enum</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">.into(%{})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  },</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">  </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">time:</span><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\"> </span><span class=\"grvsc-t564vY-4 grvsc-tJmpaV-4\">10</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t564vY-1 grvsc-tJmpaV-1\">)</span></span></span></code></pre>\n<p>This script will use <a href=\"https://github.com/bencheeorg/benchee\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">benchee</a> to compare functions with <code>map_size</code> and <code>==</code> guard clauses on four different size maps.</p>\n<p>After a few runs with different times, I found the options were equivalent speed-wise. Here is a sample result from a ten-second benchmark.</p>\n<pre class=\"grvsc-container tomorrow grvsc-ps-tJmpaV\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Operating System: macOS</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">CPU Information: Intel(R) Core(TM) i7-4771 CPU @ 3.50GHz</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Number of Available Cores: 8</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Available memory: 32 GB</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Elixir 1.12.3</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Erlang 24.1.2</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmark suite executing with the following configuration:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">warmup: 2 s</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">time: 10 s</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">memory time: 0 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">parallel: 1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">inputs: Empty, Large, Medium, Small</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Estimated total run time: 1.60 min</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmarking checking size with input Empty...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmarking checking size with input Large...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmarking checking size with input Medium...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmarking checking size with input Small...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmarking matching map with input Empty...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmarking matching map with input Large...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmarking matching map with input Medium...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Benchmarking matching map with input Small...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">##### With input Empty #####</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Name                    ips        average  deviation         median         99th %</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">checking size        7.51 M      133.13 ns Â±17314.76%           0 ns        1000 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">matching map         7.43 M      134.52 ns Â±17446.18%           0 ns        1000 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Comparison:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">checking size        7.51 M</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">matching map         7.43 M - 1.01x slower +1.40 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">##### With input Large #####</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Name                    ips        average  deviation         median         99th %</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">checking size        7.66 M      130.53 ns  Â±3435.02%           0 ns        1000 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">matching map         7.58 M      131.93 ns  Â±7672.54%           0 ns        1000 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Comparison:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">checking size        7.66 M</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">matching map         7.58 M - 1.01x slower +1.40 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">##### With input Medium #####</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Name                    ips        average  deviation         median         99th %</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">checking size        7.14 M      140.04 ns Â±22155.54%           0 ns        1000 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">matching map         7.07 M      141.45 ns Â±21487.37%           0 ns        1000 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Comparison:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">checking size        7.14 M</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">matching map         7.07 M - 1.01x slower +1.41 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">##### With input Small #####</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Name                    ips        average  deviation         median         99th %</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">matching map         7.78 M      128.49 ns  Â±3673.23%           0 ns        1000 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">checking size        7.74 M      129.22 ns  Â±3346.12%           0 ns        1000 ns</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Comparison:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">matching map         7.78 M</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">checking size        7.74 M - 1.01x slower +0.74 ns</span></span></code></pre>\n<p>These calls are both so quick that I would occasionally receive this warning from benchee:</p>\n<blockquote>\n<p>Warning: The function you are trying to benchmark is super fast, making measurements more unreliable!\nThis holds especially true for memory measurements.\nSee: <a href=\"https://github.com/PragTob/benchee/wiki/Benchee-Warnings#fast-execution-warning\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/PragTob/benchee/wiki/Benchee-Warnings#fast-execution-warning</a></p>\n</blockquote>\n<p>I suspect that this explains why I would see the results flip-flop between runs.</p>\n<p>I had expected <code>map_size</code> would be slower and slow down more as the input size increased, but the benchmarks show otherwise. If I had read the <a href=\"https://hexdocs.pm/elixir/1.12/Kernel.html#map_size/1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">documentation for <code>map_size</code></a>, I could have saved myself some time.</p>\n<blockquote>\n<p>This operation happens in constant time.</p>\n</blockquote>\n<p>Since both options appear to be essentially equivalent, I plan to default to using <code>map_size</code> since it provides the flexibility to check for more than just empty maps.</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .tomorrow {\n    background-color: #FFFFFF;\n    color: #4D4D4C;\n  }\n  .tomorrow .grvsc-t564vY-6 { color: #3E999F; }\n  .tomorrow .grvsc-t564vY-1 { color: #4D4D4C; }\n  .tomorrow .grvsc-t564vY-4 { color: #F5871F; }\n  .tomorrow .grvsc-t564vY-8 { color: #C82829; }\n  .tomorrow .grvsc-t564vY-11 { color: #8959A8; }\n  .tomorrow .grvsc-t564vY-10 { color: #4271AE; }\n  .tomorrow .grvsc-t564vY-7 { color: #718C00; }\n  .tomorrow .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n  body.dark .grvsc-ps-tJmpaV {\n    background-color: #1D1F21;\n    color: #C5C8C6;\n  }\n  body.dark .grvsc-ps-tJmpaV .grvsc-tJmpaV-6 { color: #8ABEB7; }\n  body.dark .grvsc-ps-tJmpaV .grvsc-tJmpaV-1 { color: #C5C8C6; }\n  body.dark .grvsc-ps-tJmpaV .grvsc-tJmpaV-4 { color: #DE935F; }\n  body.dark .grvsc-ps-tJmpaV .grvsc-tJmpaV-8 { color: #CC6666; }\n  body.dark .grvsc-ps-tJmpaV .grvsc-tJmpaV-11 { color: #B294BB; }\n  body.dark .grvsc-ps-tJmpaV .grvsc-tJmpaV-10 { color: #81A2BE; }\n  body.dark .grvsc-ps-tJmpaV .grvsc-tJmpaV-7 { color: #B5BD68; }\n  body.dark .grvsc-ps-tJmpaV .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"title":"Pattern Matching Empty Maps with Elixir","date":"November 30, 2021"}}},"pageContext":{"slug":"/2021/11/pattern-matching-empty-map-with-elixir/","previous":{"fields":{"slug":"/2021/10/using-mix-install-for-benchmarks/"},"frontmatter":{"title":"Using Mix.install for Benchmarks"}},"next":{"fields":{"slug":"/2021/12/2021-gratitude/"},"frontmatter":{"title":"2021 Gratitude"}}}},"staticQueryHashes":["3128451518","3649515864"]}